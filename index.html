<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HSK 1 Fe'llar - Dilfuza Kāng lǎo shī</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons (Vanilla JS version - safer for browser usage) -->
    <script src="https://unpkg.com/lucide@0.292.0/dist/umd/lucide.min.js"></script>

    <style>
        /* Custom utilities for 3D card flip effect */
        .perspective { perspective: 1000px; }
        .preserve-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        /* Prevent text selection for better app-like feel */
        .noselect {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body class="bg-gray-50 noselect">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Custom Icon Component Wrapper ---
        // This bridges the vanilla lucide library to React components
        // ensuring robustness even if UMD dependencies fail.
        const LucideIcon = ({ name, size = 24, color = "currentColor", className = "", strokeWidth = 2, ...props }) => {
            const [iconData, setIconData] = useState(null);

            useEffect(() => {
                if (window.lucide && window.lucide.icons && window.lucide.icons[name]) {
                    setIconData(window.lucide.icons[name]);
                } else {
                    console.warn(`Icon "${name}" not found or Lucide library missing.`);
                }
            }, [name]);

            if (!iconData) {
                // Fallback placeholder if icon fails to load
                return (
                    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={`opacity-20 ${className}`} {...props}>
                        <circle cx="12" cy="12" r="10" />
                    </svg>
                );
            }

            // Lucide structure: [tag, attrs, children]
            const [tag, defaultAttrs, children] = iconData;

            // Convert kebab-case attributes to camelCase for React
            const toCamelCase = (str) => str.replace(/-([a-z])/g, (g) => g[1].toUpperCase());
            
            const processAttrs = (attrs) => {
                const newAttrs = {};
                for (const key in attrs) {
                    const camelKey = toCamelCase(key);
                    // Handle specific edge cases if needed, but simple camelCase works for most SVG attrs in React 18
                    newAttrs[camelKey] = attrs[key];
                }
                return newAttrs;
            };

            const reactDefaultAttrs = processAttrs(defaultAttrs);

            return (
                <svg
                    {...reactDefaultAttrs}
                    width={size}
                    height={size}
                    stroke={color !== "currentColor" && !className.includes("text-") ? color : "currentColor"}
                    strokeWidth={strokeWidth}
                    className={`lucide lucide-${name.toLowerCase()} ${className}`}
                    {...props}
                >
                    {children.map(([childTag, childAttrs], index) => (
                        React.createElement(childTag, { 
                            key: index, 
                            ...processAttrs(childAttrs) 
                        })
                    ))}
                </svg>
            );
        };

        // HSK 1 Verbs Data with Uzbek translations and Icon NAMES (String)
        const verbsData = [
          { char: '爱', pinyin: 'ài', uzbek: 'Sevmoq', icon: 'Heart', color: 'text-red-500' },
          { char: '唱', pinyin: 'chàng', uzbek: 'Kuylamoq', icon: 'Music', color: 'text-purple-500' },
          { char: '吃', pinyin: 'chī', uzbek: 'Yemoq', icon: 'Utensils', color: 'text-orange-500' },
          { char: '穿', pinyin: 'chuān', uzbek: 'Kiyinmoq', icon: 'Shirt', color: 'text-blue-500' },
          { char: '到', pinyin: 'dào', uzbek: 'Yetib kelmoq', icon: 'MapPin', color: 'text-green-600' },
          { char: '读', pinyin: 'dú', uzbek: "O'qimoq", icon: 'BookOpen', color: 'text-indigo-600' },
          { char: '给', pinyin: 'gěi', uzbek: 'Bermoq', icon: 'Gift', color: 'text-pink-500' },
          { char: '喝', pinyin: 'hē', uzbek: 'Ichmoq', icon: 'Coffee', color: 'text-amber-700' },
          { char: '回', pinyin: 'huí', uzbek: 'Qaytmoq', icon: 'RotateCcw', color: 'text-blue-400' },
          { char: '会', pinyin: 'huì', uzbek: 'Qila olmoq / Uchratmoq', icon: 'Users', color: 'text-teal-600' },
          { char: '见', pinyin: 'jiàn', uzbek: "Ko'rmoq / Uchrasmoq", icon: 'Eye', color: 'text-cyan-500' },
          { char: '叫', pinyin: 'jiào', uzbek: 'Chaqirmoq / Nomlanmoq', icon: 'Volume2', color: 'text-yellow-600' },
          { char: '开', pinyin: 'kāi', uzbek: 'Ochmoq / Haydamoq', icon: 'Key', color: 'text-yellow-500' },
          { char: '看', pinyin: 'kàn', uzbek: "Ko'rmoq / Qaramoq", icon: 'Eye', color: 'text-indigo-500' },
          { char: '来', pinyin: 'lái', uzbek: 'Kelmoq', icon: 'ArrowRight', color: 'text-green-500' },
          { char: '买', pinyin: 'mǎi', uzbek: 'Sotib olmoq', icon: 'ShoppingCart', color: 'text-blue-600' },
          { char: '卖', pinyin: 'mài', uzbek: 'Sotmoq', icon: 'Store', color: 'text-red-600' },
          { char: '能', pinyin: 'néng', uzbek: 'Qila olmoq (imkon)', icon: 'Zap', color: 'text-yellow-400' },
          { char: '起', pinyin: 'qǐ', uzbek: "Turmoq (o'rnidan)", icon: 'Sunrise', color: 'text-orange-400' },
          { char: '请', pinyin: 'qǐng', uzbek: 'Iltimos qilmoq / Taklif qilmoq', icon: 'MessageCircle', color: 'text-pink-400' },
          { char: '去', pinyin: 'qù', uzbek: 'Bormoq', icon: 'Navigation', color: 'text-blue-500' },
          { char: '认识', pinyin: 'rènshi', uzbek: 'Tanishmoq / Bilmoq', icon: 'UserPlus', color: 'text-purple-600' },
          { char: '上', pinyin: 'shàng', uzbek: 'Yuqoriga / Bormoq (darsga)', icon: 'ArrowUp', color: 'text-gray-600' },
          { char: '下', pinyin: 'xià', uzbek: 'Pastga / Tugamoq (dars)', icon: 'ArrowDown', color: 'text-gray-600' },
          { char: '睡', pinyin: 'shuì', uzbek: 'Uxlamoq', icon: 'Moon', color: 'text-indigo-800' },
          { char: '说', pinyin: 'shuō', uzbek: 'Gapirmoq', icon: 'Mic', color: 'text-red-400' },
          { char: '听', pinyin: 'tīng', uzbek: 'Tinglamoq', icon: 'Ear', color: 'text-yellow-600' },
          { char: '玩', pinyin: 'wán', uzbek: "O'ynamoq", icon: 'Gamepad2', color: 'text-green-500' },
          { char: '问', pinyin: 'wèn', uzbek: "So'ramoq", icon: 'HelpCircle', color: 'text-blue-400' },
          { char: '喜欢', pinyin: 'xǐhuan', uzbek: 'Yoqtirmoq', icon: 'ThumbsUp', color: 'text-pink-500' },
          { char: '想', pinyin: 'xiǎng', uzbek: "O'ylamoq / Xohlamoq", icon: 'Brain', color: 'text-purple-400' },
          { char: '写', pinyin: 'xiě', uzbek: 'Yozmoq', icon: 'PenTool', color: 'text-gray-700' },
          { char: '学', pinyin: 'xué', uzbek: "O'rganmoq", icon: 'GraduationCap', color: 'text-blue-800' },
          { char: '要', pinyin: 'yào', uzbek: 'Kerak / Xohlamoq', icon: 'AlertCircle', color: 'text-red-500' },
          { char: '有', pinyin: 'yǒu', uzbek: 'Bor bo’lmoq', icon: 'Briefcase', color: 'text-amber-600' },
          { char: '找', pinyin: 'zhǎo', uzbek: 'Qidirmoq', icon: 'Search', color: 'text-teal-500' },
          { char: '住', pinyin: 'zhù', uzbek: 'Yashamoq', icon: 'Home', color: 'text-green-700' },
          { char: '做', pinyin: 'zuò', uzbek: 'Qilmoq / Bajarmoq', icon: 'Hammer', color: 'text-gray-500' },
          { char: '坐', pinyin: 'zuò', uzbek: "O'tirmoq", icon: 'Armchair', color: 'text-indigo-500' },
          // New Verbs
          { char: '在', pinyin: 'zài', uzbek: "Mavjud bo'lmoq / -da (joy)", icon: 'MapPin', color: 'text-emerald-500' },
          { char: '知道', pinyin: 'zhīdào', uzbek: 'Bilmoq', icon: 'Lightbulb', color: 'text-yellow-500' },
          { char: '休息', pinyin: 'xiūxi', uzbek: 'Dam olmoq', icon: 'PauseCircle', color: 'text-orange-400' },
          { char: '起床', pinyin: 'qǐchuáng', uzbek: 'Uyqudan turmoq', icon: 'Sun', color: 'text-amber-500' },
          { char: '看见', pinyin: 'kànjiàn', uzbek: "Ko'rib qolmoq", icon: 'Glasses', color: 'text-indigo-400' },
          { char: '开车', pinyin: 'kāichē', uzbek: 'Mashina haydamoq', icon: 'Car', color: 'text-blue-600' },
        ];

        const speak = (text) => {
          if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel(); // Cancel any current speech
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN';
            window.speechSynthesis.speak(utterance);
          }
        };

        function App() {
          const [currentTab, setCurrentTab] = useState('learn'); // learn, list, quiz, listen
          const [currentIndex, setCurrentIndex] = useState(0);
          const [isFlipped, setIsFlipped] = useState(false);
          
          // Quiz State
          const [quizQuestion, setQuizQuestion] = useState(null);
          const [quizOptions, setQuizOptions] = useState([]);
          const [quizScore, setQuizScore] = useState(0);
          const [quizTotal, setQuizTotal] = useState(0);
          const [feedback, setFeedback] = useState(null); // 'correct' or 'wrong'

          useEffect(() => {
            if (currentTab === 'quiz' || currentTab === 'listen') {
              generateQuiz();
            }
          }, [currentTab]);

          // Auto-play audio when switching questions in listen mode
          useEffect(() => {
            if (currentTab === 'listen' && quizQuestion && !feedback) {
               // Slight delay to be less startling on page load
               const timer = setTimeout(() => {
                   speak(quizQuestion.char);
               }, 600);
               return () => clearTimeout(timer);
            }
          }, [quizQuestion, currentTab, feedback]);

          const nextCard = () => {
            setIsFlipped(false);
            setCurrentIndex((prev) => (prev + 1) % verbsData.length);
          };

          const prevCard = () => {
            setIsFlipped(false);
            setCurrentIndex((prev) => (prev - 1 + verbsData.length) % verbsData.length);
          };

          const generateQuiz = () => {
            setFeedback(null);
            const questionIndex = Math.floor(Math.random() * verbsData.length);
            const correctVerb = verbsData[questionIndex];
            
            // Generate 3 random wrong answers
            let options = [correctVerb];
            while (options.length < 4) {
              const randomIdx = Math.floor(Math.random() * verbsData.length);
              const randomVerb = verbsData[randomIdx];
              if (!options.find(o => o.char === randomVerb.char)) {
                options.push(randomVerb);
              }
            }
            
            // Shuffle options
            options = options.sort(() => Math.random() - 0.5);
            
            setQuizQuestion(correctVerb);
            setQuizOptions(options);
          };

          const handleQuizAnswer = (selectedVerb) => {
            if (feedback) return; // Prevent double clicking

            setQuizTotal(prev => prev + 1);
            if (selectedVerb.char === quizQuestion.char) {
              setFeedback('correct');
              setQuizScore(prev => prev + 1);
              speak('对'); // Correct feedback
              setTimeout(() => generateQuiz(), 2000); // Slower transition in listen mode to see the character
            } else {
              setFeedback('wrong');
              speak('不对'); 
              setTimeout(() => generateQuiz(), 2000);
            }
          };

          return (
            <div className="min-h-screen bg-gray-50 flex flex-col font-sans text-slate-800">
              {/* Header */}
              <header className="bg-gradient-to-r from-red-600 to-red-800 text-white p-2 md:p-4 shadow-lg sticky top-0 z-10">
                <div className="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center gap-2 md:gap-0">
                  <div className="text-center md:text-left">
                    <h1 className="text-lg md:text-2xl font-bold flex items-center justify-center md:justify-start gap-2">
                      <LucideIcon name="BookOpen" size={24} className="w-5 h-5 md:w-6 md:h-6" />
                      HSK 1 Fe'llar
                    </h1>
                    <p className="text-[10px] md:text-sm text-red-100 opacity-90">Dilfuza Kāng lǎo shī bilan xitoy tilini o'rganmiz</p>
                  </div>
                  <div className="flex bg-red-900/30 rounded-lg p-1 w-full md:w-auto justify-between md:justify-center overflow-x-auto">
                    <button 
                      onClick={() => setCurrentTab('learn')} 
                      className={`flex-1 min-w-[60px] md:flex-none px-2 py-1.5 md:px-3 md:py-1 rounded-md text-xs md:text-sm transition whitespace-nowrap ${currentTab === 'learn' ? 'bg-white text-red-700 shadow' : 'text-white hover:bg-white/10'}`}
                    >
                      Kartalar
                    </button>
                    <button 
                      onClick={() => setCurrentTab('quiz')} 
                      className={`flex-1 min-w-[60px] md:flex-none px-2 py-1.5 md:px-3 md:py-1 rounded-md text-xs md:text-sm transition whitespace-nowrap ${currentTab === 'quiz' ? 'bg-white text-red-700 shadow' : 'text-white hover:bg-white/10'}`}
                    >
                      Test
                    </button>
                     <button 
                      onClick={() => setCurrentTab('listen')} 
                      className={`flex-1 min-w-[60px] md:flex-none px-2 py-1.5 md:px-3 md:py-1 rounded-md text-xs md:text-sm transition whitespace-nowrap ${currentTab === 'listen' ? 'bg-white text-red-700 shadow' : 'text-white hover:bg-white/10'}`}
                    >
                      Tinglash
                    </button>
                    <button 
                      onClick={() => setCurrentTab('list')} 
                      className={`flex-1 min-w-[60px] md:flex-none px-2 py-1.5 md:px-3 md:py-1 rounded-md text-xs md:text-sm transition whitespace-nowrap ${currentTab === 'list' ? 'bg-white text-red-700 shadow' : 'text-white hover:bg-white/10'}`}
                    >
                      Ro'yxat
                    </button>
                  </div>
                </div>
              </header>

              {/* Main Content */}
              <main className="flex-1 max-w-4xl mx-auto w-full p-2 md:p-6 overflow-hidden flex flex-col">
                
                {/* LEARN MODE */}
                {currentTab === 'learn' && (
                  <div className="flex flex-col items-center justify-center flex-1 min-h-[50vh] md:min-h-[70vh]">
                    
                    {/* Progress Bar */}
                    <div className="w-full max-w-xs md:max-w-md bg-gray-200 rounded-full h-1.5 md:h-2 mb-4">
                      <div 
                        className="bg-red-600 h-1.5 md:h-2 rounded-full transition-all duration-300" 
                        style={{ width: `${((currentIndex + 1) / verbsData.length) * 100}%` }}
                      ></div>
                      <p className="text-center text-[10px] md:text-xs text-gray-500 mt-1">
                        {currentIndex + 1} / {verbsData.length}
                      </p>
                    </div>

                    {/* Flip Card - Adjusted for mobile height */}
                    <div 
                      className="group perspective w-full max-w-[280px] md:max-w-sm h-72 md:h-96 cursor-pointer"
                      onClick={() => setIsFlipped(!isFlipped)}
                    >
                      <div className={`relative preserve-3d w-full h-full duration-500 ${isFlipped ? 'rotate-y-180' : ''}`}>
                        
                        {/* Front Side */}
                        <div className="absolute backface-hidden w-full h-full bg-white rounded-2xl md:rounded-3xl shadow-xl border-b-4 md:border-b-8 border-red-600 flex flex-col items-center justify-center p-4 md:p-8">
                          <div className={`absolute top-3 right-3 md:top-4 md:right-4 ${verbsData[currentIndex].color} opacity-20`}>
                             <LucideIcon name={verbsData[currentIndex].icon} size={32} className="md:w-16 md:h-16" />
                          </div>
                          
                          {/* Visual Icon Centered */}
                          <div className={`mb-4 md:mb-6 p-3 md:p-4 rounded-full bg-gray-50 ${verbsData[currentIndex].color}`}>
                            <LucideIcon name={verbsData[currentIndex].icon} size={40} strokeWidth={1.5} className="md:w-16 md:h-16" />
                          </div>

                          <h2 className="text-6xl md:text-8xl font-black text-gray-800 mb-2">{verbsData[currentIndex].char}</h2>
                          <p className="text-gray-400 text-[10px] md:text-sm mt-2 md:mt-4 animate-pulse">Tarjimani ko'rish uchun bosing</p>
                        </div>

                        {/* Back Side */}
                        <div className="absolute rotate-y-180 backface-hidden w-full h-full bg-slate-900 text-white rounded-2xl md:rounded-3xl shadow-xl border-b-4 md:border-b-8 border-slate-700 flex flex-col items-center justify-center p-4 md:p-8">
                          <div className="flex items-center gap-3 mb-3 md:mb-4">
                             <h2 className="text-5xl md:text-6xl font-bold">{verbsData[currentIndex].char}</h2>
                             <button 
                               onClick={(e) => { e.stopPropagation(); speak(verbsData[currentIndex].char); }}
                               className="p-2 md:p-3 bg-red-600 rounded-full hover:bg-red-500 transition shadow-lg active:scale-95"
                             >
                               <LucideIcon name="Volume2" size={20} className="md:w-6 md:h-6" />
                             </button>
                          </div>
                          
                          <p className="text-2xl md:text-3xl text-red-400 font-mono mb-3 md:mb-6">{verbsData[currentIndex].pinyin}</p>
                          
                          <div className="w-full h-px bg-slate-700 mb-3 md:mb-6"></div>
                          
                          <div className="text-center">
                            <p className="text-slate-400 text-[10px] md:text-sm uppercase tracking-widest mb-1">O'zbekcha</p>
                            <p className="text-lg md:text-2xl font-bold text-yellow-400 leading-tight px-2">{verbsData[currentIndex].uzbek}</p>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Controls */}
                    <div className="flex items-center justify-between w-full max-w-[280px] md:max-w-sm mt-6 md:mt-8 gap-3 md:gap-4">
                      <button 
                        onClick={prevCard}
                        className="p-3 md:p-4 bg-white rounded-full shadow-md hover:bg-gray-50 text-gray-700 transition active:scale-95 border border-gray-200"
                      >
                        <LucideIcon name="ChevronLeft" size={20} className="md:w-7 md:h-7" />
                      </button>
                      
                      <button 
                        onClick={() => speak(verbsData[currentIndex].char)}
                        className="flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-red-100 text-red-700 rounded-full font-bold hover:bg-red-200 transition active:scale-95"
                      >
                        <LucideIcon name="Play" size={18} className="fill-current md:w-5 md:h-5" />
                        <span className="text-sm md:text-base">Eshitish</span>
                      </button>

                      <button 
                        onClick={nextCard}
                        className="p-3 md:p-4 bg-white rounded-full shadow-md hover:bg-gray-50 text-gray-700 transition active:scale-95 border border-gray-200"
                      >
                        <LucideIcon name="ChevronRight" size={20} className="md:w-7 md:h-7" />
                      </button>
                    </div>
                  </div>
                )}

                {/* QUIZ MODE */}
                {currentTab === 'quiz' && quizQuestion && (
                  <div className="max-w-2xl mx-auto flex flex-col items-center w-full">
                     <div className="w-full flex justify-between items-center mb-4 md:mb-6 bg-white p-3 md:p-4 rounded-xl shadow-sm">
                        <div>
                          <span className="text-gray-500 text-xs md:text-sm">Natija:</span>
                          <span className="ml-2 text-lg md:text-xl font-bold text-green-600">{quizScore}</span>
                          <span className="mx-1 text-gray-300">/</span>
                          <span className="text-gray-500 text-sm">{quizTotal}</span>
                        </div>
                        <button 
                          onClick={generateQuiz} 
                          className="text-xs md:text-sm flex items-center gap-1 text-blue-600 hover:underline"
                        >
                          <LucideIcon name="RotateCw" size={14} /> <span className="inline">O'tkazib yuborish</span>
                        </button>
                     </div>

                     <div className="w-full bg-white rounded-2xl md:rounded-3xl shadow-lg p-6 md:p-12 text-center mb-4 md:mb-8 relative overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-1.5 md:h-2 bg-gradient-to-r from-red-500 to-yellow-500"></div>
                        <span className="text-gray-400 text-[10px] md:text-sm uppercase tracking-wider">Bu qaysi so'z?</span>
                        <h2 className="text-5xl md:text-8xl font-black text-gray-800 my-3 md:my-6">{quizQuestion.char}</h2>
                        <button 
                           onClick={() => speak(quizQuestion.char)}
                           className="mx-auto flex items-center justify-center w-10 h-10 md:w-12 md:h-12 rounded-full bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600 transition"
                        >
                          <LucideIcon name="Volume2" size={20} className="md:w-6 md:h-6" />
                        </button>
                     </div>

                     <div className="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4 w-full">
                        {quizOptions.map((option, idx) => {
                          let btnClass = "p-4 md:p-6 rounded-xl text-sm md:text-lg font-bold shadow-sm border-2 border-transparent transition-all duration-200 flex items-center justify-between group touch-manipulation";
                          
                          if (feedback) {
                            if (option.char === quizQuestion.char) {
                              btnClass += " bg-green-100 border-green-500 text-green-800";
                            } else if (feedback === 'wrong' && option === quizOptions.find(o => o.uzbek === quizQuestion.uzbek)) {
                               btnClass += " bg-white text-gray-300";
                            } else {
                               btnClass += " bg-gray-50 text-gray-300 opacity-50";
                            }
                          } else {
                            btnClass += " bg-white hover:border-red-400 hover:shadow-md cursor-pointer text-gray-700 active:bg-gray-50";
                          }

                          return (
                            <button 
                              key={idx}
                              onClick={() => handleQuizAnswer(option)}
                              disabled={feedback !== null}
                              className={btnClass}
                            >
                              <span className="flex items-center gap-2 md:gap-3 text-left">
                                <LucideIcon name={option.icon} size={18} className={`min-w-[18px] md:min-w-[20px] ${feedback && option.char === quizQuestion.char ? "text-green-600" : "text-gray-400 group-hover:text-red-500"}`} />
                                <span className="line-clamp-1">{option.uzbek}</span>
                              </span>
                              {feedback && option.char === quizQuestion.char && <LucideIcon name="Check" className="text-green-600 flex-shrink-0" size={18} />}
                            </button>
                          );
                        })}
                     </div>
                     
                     {feedback && (
                        <div className={`mt-4 md:mt-6 px-6 py-2 md:py-3 rounded-full text-white font-bold animate-bounce text-sm md:text-base ${feedback === 'correct' ? 'bg-green-500' : 'bg-red-500'}`}>
                          {feedback === 'correct' ? "To'g'ri! (Ajoyib)" : "Xato! (Qayta urinib ko'ring)"}
                        </div>
                     )}
                  </div>
                )}

                 {/* LISTEN MODE */}
                {currentTab === 'listen' && quizQuestion && (
                  <div className="max-w-2xl mx-auto flex flex-col items-center w-full">
                     <div className="w-full flex justify-between items-center mb-4 md:mb-6 bg-white p-3 md:p-4 rounded-xl shadow-sm">
                        <div>
                          <span className="text-gray-500 text-xs md:text-sm">Natija:</span>
                          <span className="ml-2 text-lg md:text-xl font-bold text-green-600">{quizScore}</span>
                          <span className="mx-1 text-gray-300">/</span>
                          <span className="text-gray-500 text-sm">{quizTotal}</span>
                        </div>
                        <button 
                          onClick={generateQuiz} 
                          className="text-xs md:text-sm flex items-center gap-1 text-blue-600 hover:underline"
                        >
                          <LucideIcon name="RotateCw" size={14} /> <span className="inline">O'tkazib yuborish</span>
                        </button>
                     </div>

                     <div className="w-full bg-white rounded-2xl md:rounded-3xl shadow-lg p-6 md:p-12 text-center mb-4 md:mb-8 relative overflow-hidden min-h-[200px] flex flex-col items-center justify-center">
                        <div className="absolute top-0 left-0 w-full h-1.5 md:h-2 bg-gradient-to-r from-blue-500 to-purple-500"></div>
                        
                        {!feedback ? (
                            <>
                                <span className="text-gray-400 text-[10px] md:text-sm uppercase tracking-wider mb-4">Tinglang va toping</span>
                                <button 
                                   onClick={() => speak(quizQuestion.char)}
                                   className="mx-auto flex items-center justify-center w-24 h-24 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 hover:scale-105 transition-all shadow-md animate-pulse"
                                >
                                  <LucideIcon name="Ear" size={48} />
                                </button>
                                <p className="mt-4 text-gray-500 text-sm">Ovozni qayta eshitish uchun bosing</p>
                            </>
                        ) : (
                            <div className="animate-in fade-in zoom-in duration-300">
                                <span className="text-gray-400 text-[10px] md:text-sm uppercase tracking-wider">Javob</span>
                                <h2 className="text-5xl md:text-8xl font-black text-gray-800 my-3 md:my-6">{quizQuestion.char}</h2>
                                <p className="text-2xl text-red-500 font-mono">{quizQuestion.pinyin}</p>
                            </div>
                        )}
                     </div>

                     <div className="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4 w-full">
                        {quizOptions.map((option, idx) => {
                          let btnClass = "p-4 md:p-6 rounded-xl text-sm md:text-lg font-bold shadow-sm border-2 border-transparent transition-all duration-200 flex items-center justify-between group touch-manipulation";
                          
                          if (feedback) {
                            if (option.char === quizQuestion.char) {
                              btnClass += " bg-green-100 border-green-500 text-green-800";
                            } else if (feedback === 'wrong' && option === quizOptions.find(o => o.uzbek === quizQuestion.uzbek)) {
                               btnClass += " bg-white text-gray-300";
                            } else {
                               btnClass += " bg-gray-50 text-gray-300 opacity-50";
                            }
                          } else {
                            btnClass += " bg-white hover:border-blue-400 hover:shadow-md cursor-pointer text-gray-700 active:bg-gray-50";
                          }

                          return (
                            <button 
                              key={idx}
                              onClick={() => handleQuizAnswer(option)}
                              disabled={feedback !== null}
                              className={btnClass}
                            >
                              <span className="flex items-center gap-2 md:gap-3 text-left">
                                <span className="line-clamp-1">{option.uzbek}</span>
                              </span>
                              {feedback && option.char === quizQuestion.char && <LucideIcon name="Check" className="text-green-600 flex-shrink-0" size={18} />}
                            </button>
                          );
                        })}
                     </div>
                     
                     {feedback && (
                        <div className={`mt-4 md:mt-6 px-6 py-2 md:py-3 rounded-full text-white font-bold animate-bounce text-sm md:text-base ${feedback === 'correct' ? 'bg-green-500' : 'bg-red-500'}`}>
                          {feedback === 'correct' ? "To'g'ri! (Ajoyib)" : "Xato! (Qayta urinib ko'ring)"}
                        </div>
                     )}
                  </div>
                )}

                {/* LIST MODE */}
                {currentTab === 'list' && (
                  <div className="bg-white rounded-xl md:rounded-2xl shadow-lg overflow-hidden flex-1 flex flex-col">
                    <div className="grid grid-cols-12 bg-gray-100 p-2 md:p-4 font-bold text-gray-600 border-b text-[10px] md:text-base sticky top-0">
                      <div className="col-span-2 text-center">Xitoycha</div>
                      <div className="col-span-3 text-center">Pinyin</div>
                      <div className="col-span-5">O'zbekcha</div>
                      <div className="col-span-2 text-center">Ovoz</div>
                    </div>
                    <div className="divide-y divide-gray-100 overflow-y-auto flex-1 text-xs md:text-base">
                      {verbsData.map((item, idx) => (
                        <div key={idx} className="grid grid-cols-12 p-2 md:p-4 hover:bg-red-50 transition items-center">
                          <div className="col-span-2 text-center text-lg md:text-2xl font-bold text-gray-800 flex flex-col items-center gap-1">
                            {item.char}
                          </div>
                          <div className="col-span-3 text-center text-red-600 font-medium break-words px-1">{item.pinyin}</div>
                          <div className="col-span-5 text-gray-700 flex items-center gap-1 md:gap-2">
                             <div className="hidden md:block">
                                <LucideIcon name={item.icon} size={20} className={item.color} />
                             </div>
                             <span className="line-clamp-2 leading-tight">{item.uzbek}</span>
                          </div>
                          <div className="col-span-2 flex justify-center">
                            <button 
                              onClick={() => speak(item.char)}
                              className="p-1.5 md:p-2 bg-gray-100 rounded-full hover:bg-red-100 hover:text-red-600 text-gray-400 transition"
                            >
                              <LucideIcon name="Volume2" size={14} className="md:w-[18px] md:h-[18px]" />
                            </button>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

              </main>

              {/* Footer */}
              <footer className="p-3 md:p-6 text-center text-gray-400 text-[10px] md:text-sm bg-gray-100 border-t mt-auto">
                <p>Uzbek-Chinese Learning Assistant @diffila(telegram)</p>
              </footer>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>